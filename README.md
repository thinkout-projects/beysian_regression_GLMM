# ベイズ推定（一般化線形混合model）による標準化回帰係数の算出application
(論文にしようしているものなので、データの公開は知人のみ)

### 一般化線形混合modelとは？
ベイズ推定の中で、特に<span style="color: red; ">個人間の影響</span>を考えられるようにしたもの

今回のmodelはランダム切片modelというもの。<br>

$$
    Y'[n] \sim Normal( α[PID[n]] + βX'[n], \sigma_{Y} )         n = 1,\ldots, N\\ 
    α[k] = α_{all} + α_{id}[k]                                          k = 1,\ldots, K\\
    α_{id}[k]  \sim Normal(0, \sigma_{α})                          k = 1,\ldots, K\\     
$$
<br>
$ Y = ax+b $
という式があるとするならば、実際には測定や予測にある程度「ゆらぎ」があるので、実際には
$ Y \sim Normal(ax+b, \sigma_{Y}) $
とある確率分布になるというのがベイズ推定でよく用いられる考え方。<br>

さらに、一般化線形混合modelはa,bが人によってばらつきがある「だろう」というのを前提にしてmodelを組むものとなっている。

今回は、a (つまり切片)のみに揺らぎがある可能性があるとして、βは人によって変わらないと仮定。それによって、標準化回帰係数が求められる。

### 結局ベイズ推定で何が求められるの？
誤解をおそれずに言うなら、それらしいようにランダムに出力された数値の群。
parametersブロックで宣言された変数(a0, b, ak[K], s_a, s_Y)およびtransformed parametersブロックで宣言された変数(a[k])のそれぞれについて
chain数 * (iter - warmup)分の数値が出力される。<br>
それの中央値や2.5パーセンタイルー97.5パーセンタイルを用いることで、代表値や信頼区間を産出したりする。

### 標準化回帰係数とは？
$ Y = ax+b $
においてYが1万くらいのオーダーのもの、xが0〜1のオーダーのものだと、aがおそらく10000overになるが、aの値が大きければ非常に重要かと言えばそうとは限らない。

故に、同じくらいのオーダーに持ってくる必要がある。
そのために
$ x' = \frac{x-\mu_{x}}{\sigma_{x}} $
$ y' = \frac{y-\mu_{y}}{\sigma_{y}} $
とすることによって、平均0, 分散1にx,yを正規化する。

$ Y' = a'x'+b' $
こうしてもとめたa'が標準化回帰係数